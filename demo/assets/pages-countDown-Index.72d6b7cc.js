import{a2 as e,t as s,g as t,x as a,l as o,i as l,b as n,d as i,e as r,a as u}from"./page-wraper.b2442bab.js";import{r as c,q as m,Y as d,d as f,v as p,o as h,c as v,w,x as S,u as _,e as g,F as y,b as H,t as b,n as k,y as x,i as D,a as j,a6 as M,h as F,j as I}from"./index-a29608c3.js";import{_ as C}from"./demo-block.bb8975dc.js";import{_ as A,a as $}from"./wd-grid.20a29cd6.js";import"./wd-badge.1dc64e8b.js";import"./useChildren.8329aa88.js";const q=1e3,G=60*q,N=60*G,R=24*N;function Y(e){return requestAnimationFrame(e)}function z(e){let t,a,o=null;const l=c(e.time),n=m((()=>{return{total:e=l.value,days:Math.floor(e/R),hours:Math.floor(e%R/N),minutes:Math.floor(e%N/G),seconds:Math.floor(e%G/q),milliseconds:Math.floor(e%q)};var e})),i=()=>{a=!1,cancelAnimationFrame(o)},r=()=>Math.max(t-Date.now(),0),u=t=>{l.value=t,s(e.onChange)&&e.onChange(n.value),0===t&&(i(),s(e.onFinish)&&e.onFinish())},f=()=>{o=Y((()=>{a&&(u(r()),l.value>0&&f())}))},p=()=>{o=Y((()=>{if(a){const t=r();e=t,s=l.value,(Math.floor(e/1e3)!==Math.floor(s/1e3)||0===t)&&u(t),l.value>0&&p()}var e,s}))};return d(i),{start:()=>{a||(t=Date.now()+l.value,a=!0,e.millisecond?f():p())},pause:i,reset:(s=e.time)=>{i(),l.value=s},current:n}}const B=n(f({name:"wd-count-down",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...t,time:a(Number),millisecond:o(!1),format:l("HH:mm:ss"),autoStart:o(!0)},emits:["change","finish"],setup(s,{expose:t,emit:a}){const o=s,{start:l,pause:n,reset:i,current:r}=z({time:o.time,millisecond:o.millisecond,onChange:e=>a("change",e),onFinish:()=>a("finish")}),u=m((()=>function(s,t){const{days:a}=t;let{hours:o,minutes:l,seconds:n,milliseconds:i}=t;if(s.includes("DD")?s=s.replace("DD",e(a)):o+=24*a,s.includes("HH")?s=s.replace("HH",e(o)):l+=60*o,s.includes("mm")?s=s.replace("mm",e(l)):n+=60*l,s.includes("ss")?s=s.replace("ss",e(n)):i+=1e3*n,s.includes("S")){const t=e(i,3);s=s.includes("SSS")?s.replace("SSS",t):s.includes("SS")?s.replace("SS",t.slice(0,2)):s.replace("S",t.charAt(0))}return s}(o.format,r.value))),c=()=>{i(o.time),o.autoStart&&l()};return p((()=>o.time),c,{immediate:!0}),t({start:l,pause:n,reset:c}),(e,s)=>{const t=D;return h(),v(t,{class:k(`wd-count-down ${e.customClass}`),style:x(e.customStyle)},{default:w((()=>[e.$slots.default?S(e.$slots,"default",{key:0,current:_(r)},void 0,!0):(h(),g(y,{key:1},[H(b(_(u)),1)],64))])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-9d337e25"]]),E=n(f({__name:"Index",setup(e){const{show:s}=i(),t=c(108e6),a=c(null),o=()=>{a.value.start()},l=()=>{a.value.pause()},n=()=>{a.value.reset()},m=()=>s("倒计时结束");return(e,s)=>{const i=F(I("wd-toast"),r),c=F(I("wd-count-down"),B),d=F(I("demo-block"),C),f=F(I("wd-grid-item"),A),p=F(I("wd-grid"),$),S=F(I("page-wraper"),u);return h(),v(S,null,{default:w((()=>[j(i),j(d,{title:"基本用法"},{default:w((()=>[j(c,{time:t.value},null,8,["time"])])),_:1}),j(d,{title:"自定义格式"},{default:w((()=>[j(c,{time:t.value,format:"DD 天 HH 时 mm 分 ss 秒"},null,8,["time"])])),_:1}),j(d,{title:"毫秒级渲染"},{default:w((()=>[j(c,{time:t.value,millisecond:"",format:"HH:mm:ss:SS"},null,8,["time"])])),_:1}),j(d,{title:"自定义样式"},{default:w((()=>[j(c,{time:t.value},{default:w((({current:e})=>[M("span",{class:"custom-count-down"},b(e.hours),1),M("span",{class:"custom-count-down-colon"},":"),M("span",{class:"custom-count-down"},b(e.minutes),1),M("span",{class:"custom-count-down-colon"},":"),M("span",{class:"custom-count-down"},b(e.seconds),1)])),_:1},8,["time"])])),_:1}),j(d,{title:"手动控制"},{default:w((()=>[j(c,{ref_key:"countDown",ref:a,time:3e3,millisecond:"","auto-start":!1,format:"ss:SSS",onFinish:m},null,512),j(p,{clickable:"",border:""},{default:w((()=>[j(f,{text:"开始",icon:"play-circle-stroke",onItemclick:o}),j(f,{text:"暂停",icon:"pause-circle",onItemclick:l}),j(f,{text:"重置",icon:"refresh",onItemclick:n})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-aa320b6d"]]);export{E as default};
